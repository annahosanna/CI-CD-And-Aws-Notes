Write a Dockerfile which is based on Amazon Linux 2023 image, then install Busybox, then install curl-devel, then install root ca, then install socklog, then install openjdk headless, then install wget, then install .net, then build OpenSSH from source code without tcl/tk and GetText, then build Git from source code without tcl/tk and GetText, then enable RSA in sshd_config, then install the Gitlab ce client, then create an Entrypoint which imports the Gitlab client ssh key from /dev/1/environ (spllitting the value on the "=" sign) and ensures it not blank at runtime, if the ssh key is not blank then write it to .id_rsa and set the permissions of .id_rsa), if the ssh key is blank then exit, then start sshd, then execute proot at runtime (proot should exclude /etc/mtab, etc/resolv.conf, /etc/hosts, /etc, /sys, and /proc) and execute kaniko with proot in a subdirectory, then execute the Entrypoint using Tini, then "sleep infinity" at the end of the Endtrypoint, then create the Cloudformation which executes this Fargate container with SYS_PTRACE enabled and creates the security group and subnet for it.
